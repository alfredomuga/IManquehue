{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Nombre de instancia de Data Factory",
			"defaultValue": "Data-Factory-BI"
		},
		"DWIM2_connectionString": {
			"type": "secureString",
			"metadata": "Cadena protegida para \"connectionString\"de \"DWIM2\""
		},
		"imsadatalake_accountKey": {
			"type": "secureString",
			"metadata": "Cadena protegida para \"accountKey\"de \"imsadatalake\""
		},
		"Publicar OC_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://apimtanner-qa.azure-api.net/enterprise/providers-portal/integration-erp-red-proveedores/api/PurchaseOrder/SavePurchaseOrder"
		},
		"imsadatalake_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://imsadatalake.dfs.core.windows.net/"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/DWIM2')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureSqlDatabase",
				"typeProperties": {
					"connectionString": "[parameters('DWIM2_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Publicar OC')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"parameters": {
					"CompanyRut": {
						"type": "string"
					},
					"SupplierRUT": {
						"type": "string"
					},
					"OrderNumber": {
						"type": "string"
					},
					"ReceptionNumber": {
						"type": "string"
					},
					"Amount": {
						"type": "int"
					},
					"DTEType": {
						"type": "int"
					},
					"PayDays": {
						"type": "int"
					},
					"ExternalId": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "RestService",
				"typeProperties": {
					"url": "[parameters('Publicar OC_properties_typeProperties_url')]",
					"enableServerCertificateValidation": true,
					"authenticationType": "Anonymous"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/imsadatalake')]",
			"type": "Microsoft.DataFactory/factories/linkedServices",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('imsadatalake_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('imsadatalake_accountKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/007_DeudoresInmobiliarios')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Stopped",
				"pipelines": [],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Day",
						"interval": 1,
						"startTime": "2023-01-30T14:59:00",
						"timeZone": "Pacific SA Standard Time",
						"schedule": {
							"minutes": [
								0
							],
							"hours": [
								6
							]
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DWIM')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"description": "IR de la VM IMSA",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/integrationHana')]",
			"type": "Microsoft.DataFactory/factories/integrationRuntimes",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "SelfHosted",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/BaseVentas')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "imsadatalake",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataLake/DeudoresInmobiliarios"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Base",
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "BaseVentas.xlsx",
						"folderPath": "ModeloDeudoresInmobiliarios",
						"fileSystem": "imsa-files"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "PROPIEDAD",
						"type": "String"
					},
					{
						"name": "ESTADO",
						"type": "String"
					},
					{
						"name": "PROYECTO",
						"type": "String"
					},
					{
						"name": "ETAPA",
						"type": "String"
					},
					{
						"name": "SUBAGRUPACIÓN",
						"type": "String"
					},
					{
						"name": "FEECHA RECEPCIÓN MUNICIPAL",
						"type": "String"
					},
					{
						"name": "MANZANA",
						"type": "String"
					},
					{
						"name": "SITIO",
						"type": "String"
					},
					{
						"name": "M2",
						"type": "String"
					},
					{
						"name": "MT2 TERRENO",
						"type": "String"
					},
					{
						"name": "MODELO",
						"type": "String"
					},
					{
						"name": "PROGRAMA",
						"type": "String"
					},
					{
						"name": "ESTAC.",
						"type": "String"
					},
					{
						"name": "BODEGA",
						"type": "String"
					},
					{
						"name": "NOMBRE PRODUCTO ADICIONAL (*)",
						"type": "String"
					},
					{
						"name": "NOMBRE",
						"type": "String"
					},
					{
						"name": "APELLIDO PATERNO",
						"type": "String"
					},
					{
						"name": "APELLIDO MATERNO",
						"type": "String"
					},
					{
						"name": "RUT CLIENTE",
						"type": "String"
					},
					{
						"name": "GÉNERO",
						"type": "String"
					},
					{
						"name": "OCUPACIÓN",
						"type": "String"
					},
					{
						"name": "ESTADO CIVIL",
						"type": "String"
					},
					{
						"name": "PEP",
						"type": "String"
					},
					{
						"name": "RELACIONADO CON PEP",
						"type": "String"
					},
					{
						"name": "MEDIO LLEGADA",
						"type": "String"
					},
					{
						"name": "VALOR LISTA PROD. PRINCIPAL (*)",
						"type": "String"
					},
					{
						"name": "PRECIO BASE",
						"type": "String"
					},
					{
						"name": "DCTO. UF PROD. PRINCIPAL (*)",
						"type": "String"
					},
					{
						"name": "DCTO. SUB TOTAL",
						"type": "String"
					},
					{
						"name": "VALOR PROD. PRINCIPAL CON DCTO. (*)",
						"type": "String"
					},
					{
						"name": "IVA PROD. PRINCIPAL  (*)",
						"type": "String"
					},
					{
						"name": "VALOR TOTAL Bodega(*)",
						"type": "String"
					},
					{
						"name": "IVA Bodega. (*)",
						"type": "String"
					},
					{
						"name": "PRECIO BASE Bodega.",
						"type": "String"
					},
					{
						"name": "VALOR TOTAL EST (*)",
						"type": "String"
					},
					{
						"name": "IVA EST. (*)",
						"type": "String"
					},
					{
						"name": "PRECIO BASE EST.",
						"type": "String"
					},
					{
						"name": "TOTAL NETO (*)",
						"type": "String"
					},
					{
						"name": "IVA VALOR TOTAL (*)",
						"type": "String"
					},
					{
						"name": "TOTAL BRUTO (*)",
						"type": "String"
					},
					{
						"name": "VALOR TOTAL PROD. ADICIONAL (*)",
						"type": "String"
					},
					{
						"name": "VALOR LISTA PROD. PRINCIPAL UF/MT2 ",
						"type": "String"
					},
					{
						"name": "VALOR PROD. PRINCIPAL CON DCTO. UF/MT2",
						"type": "String"
					},
					{
						"name": "TOTAL",
						"type": "String"
					},
					{
						"name": "APLICA IVA",
						"type": "String"
					},
					{
						"name": "TIPO DE CARGA DE PRECIO",
						"type": "String"
					},
					{
						"name": "VALOR TERRENO TOTAL (*)",
						"type": "String"
					},
					{
						"name": "FONDO DE RESERVA",
						"type": "String"
					},
					{
						"name": "RESERVA (*)",
						"type": "String"
					},
					{
						"name": "CONTADO CONTRA PROMESA (*)",
						"type": "String"
					},
					{
						"name": "CUOTA PERIODO DE CONSTRUCCION (*)",
						"type": "String"
					},
					{
						"name": "SALDO CONTRA ESCRITURA (*)",
						"type": "String"
					},
					{
						"name": "TIPO SUBSIDIO",
						"type": "String"
					},
					{
						"name": "MONTO SUBSIDIO BASE (*)",
						"type": "String"
					},
					{
						"name": "MONTO SUBSIDIO INTEGRACION(*)",
						"type": "String"
					},
					{
						"name": "MONTO SUBSIDIO CAPTACION (*)",
						"type": "String"
					},
					{
						"name": "ESTADO SUBSIDIO",
						"type": "String"
					},
					{
						"name": "NUMERO DE SUBSIDIO",
						"type": "String"
					},
					{
						"name": "MONTO AHORRO (*)",
						"type": "String"
					},
					{
						"name": "MONTO CREDITO HIPOTECARIO (*)",
						"type": "String"
					},
					{
						"name": "ABONO (*)",
						"type": "String"
					},
					{
						"name": "FECHA CREACIÓN RESERVA",
						"type": "String"
					},
					{
						"name": "PAC",
						"type": "String"
					},
					{
						"name": "FECHA AUTORIZACIÓN RESERVA",
						"type": "String"
					},
					{
						"name": "FECHA APROBACIÓN RESERVA",
						"type": "String"
					},
					{
						"name": "FECHA ÚLTIMA MODIFICACIÓN PROMESA",
						"type": "String"
					},
					{
						"name": "FIRMA DEL COMPRADOR",
						"type": "String"
					},
					{
						"name": "NOMBRE ASEGURADORA",
						"type": "String"
					},
					{
						"name": "NÚMERO PÓLIZA",
						"type": "String"
					},
					{
						"name": "VALOR PÓLIZA",
						"type": "String"
					},
					{
						"name": "FECHA VENCIMIENTO PÓLIZA",
						"type": "String"
					},
					{
						"name": "FECHA NOTARIA PROMESA",
						"type": "String"
					},
					{
						"name": "FECHA ENTREGA CLIENTE PROMESA",
						"type": "String"
					},
					{
						"name": "VB CONTABILIDAD PROMESA",
						"type": "String"
					},
					{
						"name": "BANCO APROBACIÓN COMERCIAL",
						"type": "String"
					},
					{
						"name": "FECHA ENVÍO DATOS DE VENTA AL BANCO",
						"type": "String"
					},
					{
						"name": "FECHA APROBACIÓN DEL BANCO",
						"type": "String"
					},
					{
						"name": "TASA INTERÉS (%)",
						"type": "String"
					},
					{
						"name": "AÑOS PLAZO",
						"type": "String"
					},
					{
						"name": "FECHA APROBACIÓN ESTUDIO DE TÍTULOS",
						"type": "String"
					},
					{
						"name": "FECHA TASACIÓN ESTUDIO DE TÍTULOS",
						"type": "String"
					},
					{
						"name": "NOMBRE NOTARIA CLIENTE",
						"type": "String"
					},
					{
						"name": "NÚMERO REPERTORIO",
						"type": "String"
					},
					{
						"name": "FECHA ESCRITURA",
						"type": "String"
					},
					{
						"name": "NÚMERO RESOLUCIÓN SERVIU",
						"type": "String"
					},
					{
						"name": "FECHA RESOLUCIÓN SERVIU",
						"type": "String"
					},
					{
						"name": "FECHA ENVIO BORRADOR ESCRITURA",
						"type": "String"
					},
					{
						"name": "FECHA FIRMA CLIENTE",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO INMOBILIARIA",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO ABOGADO",
						"type": "String"
					},
					{
						"name": "FECHA VB ABOGADO",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO CORRECCIONES",
						"type": "String"
					},
					{
						"name": "FECHA SALIDA CORRECCIONES",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO A FIRMA GERENCIA",
						"type": "String"
					},
					{
						"name": "FECHA FIRMA INMOBILIARIA",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO ESCRITURA FIRMADA NOTARIA",
						"type": "String"
					},
					{
						"name": "FECHA ENVIO BANCO CLIENTE",
						"type": "String"
					},
					{
						"name": "FECHA EMISION CARTA DE RESGUARDO",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO BANCO ALZANTE",
						"type": "String"
					},
					{
						"name": "FECHA SALIDA BANCO ALZANTE",
						"type": "String"
					},
					{
						"name": "FIRMA BANCO ALZANTE",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO NOTARIA POST ALZAMIENTO",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO BANCO CLIENTE",
						"type": "String"
					},
					{
						"name": "FECHA SALIDA BANCO CLIENTE",
						"type": "String"
					},
					{
						"name": "FECHA CIERRE COPIAS",
						"type": "String"
					},
					{
						"name": "PPTO CONSERVADOR",
						"type": "String"
					},
					{
						"name": "NÚMERO DE CARATULA",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO CBR",
						"type": "String"
					},
					{
						"name": "FECHA SALIDA CBR",
						"type": "String"
					},
					{
						"name": "FECHA RECEPCION ESCRITURA INMOBILIARIA",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO COBRO SERVIU",
						"type": "String"
					},
					{
						"name": "NÚMERO LIBRETA COBRO AHORRO",
						"type": "String"
					},
					{
						"name": "FECHA INGRESO COBRO AHORRO",
						"type": "String"
					},
					{
						"name": "FECHA PAGO INSTRUCCION NOTARIAL",
						"type": "String"
					},
					{
						"name": "FECHA PAGO CREDITO",
						"type": "String"
					},
					{
						"name": "FECHA PAGO SUBSIDIO",
						"type": "String"
					},
					{
						"name": "FECHA PAGO AHORRO",
						"type": "String"
					},
					{
						"name": "FECHA ENVIO VB",
						"type": "String"
					},
					{
						"name": "FECHA DE ENTREGA",
						"type": "String"
					},
					{
						"name": "FECHA FINALIZADO",
						"type": "String"
					},
					{
						"name": "COMENTARIO PAGO",
						"type": "String"
					},
					{
						"name": "COMENTARIO NEGOCIO",
						"type": "String"
					},
					{
						"name": "VENDEDOR",
						"type": "String"
					},
					{
						"name": "RAZÓN DE COMPRA",
						"type": "String"
					},
					{
						"name": "FECHA CREACIÓN PROMESA ORIGINAL",
						"type": "String"
					},
					{
						"name": "ID PRODUCTO PRINCIPAL",
						"type": "String"
					},
					{
						"name": "ID PRODUCTOS SECUNDARIOS ESTACIONAMIENTO",
						"type": "String"
					},
					{
						"name": "ID PRODUCTOS SECUNDARIOS BODEGA",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/imsadatalake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CSV_Datalake')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "imsadatalake",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Folder": {
						"type": "string"
					},
					"File": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Otros"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().File",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().Folder",
							"type": "Expression"
						},
						"fileSystem": "imsa-files"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/imsadatalake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CSV_Datalake_Fechas')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "imsadatalake",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"ano": {
						"type": "string"
					},
					"mes": {
						"type": "string"
					},
					"dia": {
						"type": "string"
					},
					"FolderPath": {
						"type": "string"
					},
					"FileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Otros"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@concat(dataset().FolderPath,'/',dataset().ano,'/',dataset().mes,'/',dataset().dia)",
							"type": "Expression"
						},
						"fileSystem": "imsa-files"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/imsadatalake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/CSV_Datalake_Inmob')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "imsadatalake",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"FolderPath": {
						"type": "string"
					},
					"FileName": {
						"type": "string"
					}
				},
				"folder": {
					"name": "Otros"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": {
							"value": "@dataset().FileName",
							"type": "Expression"
						},
						"folderPath": {
							"value": "@dataset().FolderPath",
							"type": "Expression"
						},
						"fileSystem": "imsa-files"
					},
					"columnDelimiter": ";",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "RUT;Empresa;Proyecto;Segmento;Fecha; Importe ;Importe UF;Proyecto;Etapa;NombreProyecto;Item CC;Nombre Item(CC);Texto de la transacción;Descripcion del Diario;Mes;Año",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/imsadatalake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DLBudget')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "imsadatalake",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataLake/MasterFecha"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Budget",
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "Base Control de Hitos Relevantes.xlsx",
						"folderPath": "NuevoMasterFecha",
						"fileSystem": "imsa-files"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "Presupuesto",
						"type": "String"
					},
					{
						"name": "Proyecto",
						"type": "String"
					},
					{
						"name": "Etapa",
						"type": "String"
					},
					{
						"name": "Hito",
						"type": "String"
					},
					{
						"name": "Mes",
						"type": "String"
					},
					{
						"name": "Año",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/imsadatalake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DLForecast')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "imsadatalake",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataLake/MasterFecha"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Forecast",
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "Base Control de Hitos Relevantes.xlsx",
						"folderPath": "NuevoMasterFecha",
						"fileSystem": "imsa-files"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "Periodo",
						"type": "String"
					},
					{
						"name": "Proyecto",
						"type": "String"
					},
					{
						"name": "Etapa",
						"type": "String"
					},
					{
						"name": "Hito",
						"type": "String"
					},
					{
						"name": "Mes",
						"type": "String"
					},
					{
						"name": "Año",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/imsadatalake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DLMaestroProyectoEtapa')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "imsadatalake",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataLake/Dimensiones"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Proyecto Etapa",
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "Maestro Proyecto Etapa.xlsx",
						"folderPath": "NuevoMasterFecha",
						"fileSystem": "imsa-files"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "Activo",
						"type": "String"
					},
					{
						"name": "Etapa Comercial",
						"type": "String"
					},
					{
						"name": "Etapa Financiera",
						"type": "String"
					},
					{
						"name": "Unidades",
						"type": "String"
					},
					{
						"name": "Rut Empresa",
						"type": "String"
					},
					{
						"name": "Vigencia de Deuda",
						"type": "String"
					},
					{
						"name": "Segmento",
						"type": "String"
					},
					{
						"name": "Participacion Socios",
						"type": "String"
					},
					{
						"name": "Socio",
						"type": "String"
					},
					{
						"name": "Comuna",
						"type": "String"
					},
					{
						"name": "Constructora",
						"type": "String"
					},
					{
						"name": "Considerar Balance Inmobiliario",
						"type": "String"
					},
					{
						"name": "Costo Total",
						"type": "String"
					},
					{
						"name": "Valor Terreno",
						"type": "String"
					},
					{
						"name": "Linea Construccion Aprobada",
						"type": "String"
					},
					{
						"name": " Tipo Activo",
						"type": "String"
					},
					{
						"name": "Etapa Gestión",
						"type": "String"
					},
					{
						"name": "Etapa Constructora",
						"type": "String"
					},
					{
						"name": "Código",
						"type": "String"
					},
					{
						"name": "IVA",
						"type": "String"
					},
					{
						"name": "IFRS",
						"type": "String"
					},
					{
						"name": "Banco Alzante",
						"type": "String"
					},
					{
						"name": "Considerar Reportes Comerciales",
						"type": "String"
					},
					{
						"name": "Considerar Masterfechas",
						"type": "String"
					},
					{
						"name": "Considerar Flujo Caja",
						"type": "String"
					},
					{
						"name": "CodigoSAP",
						"type": "String"
					},
					{
						"name": "CodigoPlanOK",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/imsadatalake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DLReal')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "imsadatalake",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DataLake/MasterFecha"
				},
				"annotations": [],
				"type": "Excel",
				"typeProperties": {
					"sheetName": "Real",
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "Base Control de Hitos Relevantes.xlsx",
						"folderPath": "NuevoMasterFecha",
						"fileSystem": "imsa-files"
					},
					"firstRowAsHeader": true
				},
				"schema": [
					{
						"name": "Proyecto",
						"type": "String"
					},
					{
						"name": "Etapa",
						"type": "String"
					},
					{
						"name": "Hito",
						"type": "String"
					},
					{
						"name": "Mes",
						"type": "String"
					},
					{
						"name": "Año",
						"type": "String"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/imsadatalake')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DWDimProyectoEtapa')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DWIM2",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DW2/Dimensiones"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "idProyectoEtapa",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Proyecto",
						"type": "varchar"
					},
					{
						"name": "EtapaComercial",
						"type": "varchar"
					},
					{
						"name": "EtapaFinanciera",
						"type": "varchar"
					},
					{
						"name": "Unidades",
						"type": "int",
						"precision": 10
					},
					{
						"name": "RutEmpresa",
						"type": "varchar"
					},
					{
						"name": "Segmento",
						"type": "varchar"
					},
					{
						"name": "ParticipacionSocios",
						"type": "float",
						"precision": 15
					},
					{
						"name": "Socio",
						"type": "varchar"
					},
					{
						"name": "Comuna",
						"type": "varchar"
					},
					{
						"name": "Constructora",
						"type": "varchar"
					},
					{
						"name": "CostoTotal",
						"type": "float",
						"precision": 15
					},
					{
						"name": "ValorTerreno",
						"type": "float",
						"precision": 15
					},
					{
						"name": "LineaConstruccion",
						"type": "float",
						"precision": 15
					},
					{
						"name": "ProximoHito",
						"type": "varchar"
					},
					{
						"name": "FechaBudget",
						"type": "date"
					},
					{
						"name": "FechaForecast",
						"type": "date"
					},
					{
						"name": "Variacion",
						"type": "float",
						"precision": 15
					},
					{
						"name": "EstadoProyecto",
						"type": "varchar"
					},
					{
						"name": "TipoFinanciamientoSocios",
						"type": "varchar"
					},
					{
						"name": "VigenciaDeuda",
						"type": "varchar"
					},
					{
						"name": "TipoActivo",
						"type": "varchar"
					},
					{
						"name": "EtapaGestion",
						"type": "varchar"
					},
					{
						"name": "AtrasoMeses",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EtapaConstructora",
						"type": "varchar"
					},
					{
						"name": "Codigo",
						"type": "varchar"
					},
					{
						"name": "Considerar",
						"type": "varchar"
					},
					{
						"name": "Empresa",
						"type": "varchar"
					},
					{
						"name": "BancoAlzante",
						"type": "varchar"
					},
					{
						"name": "IVA",
						"type": "float",
						"precision": 15
					},
					{
						"name": "IFRS",
						"type": "float",
						"precision": 15
					},
					{
						"name": "Consolida",
						"type": "varchar"
					},
					{
						"name": "Act",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Act_Comercial",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Act_Masterfechas",
						"type": "varchar"
					},
					{
						"name": "Act_FlujoCaja",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "dim",
					"table": "ProyectoEtapa"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DWIM2')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DWDimSapCuenta')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DWIM2",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DW2/Dimensiones"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "idSapCuenta",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CodigoCuenta1",
						"type": "varchar"
					},
					{
						"name": "NombreCuenta1",
						"type": "varchar"
					},
					{
						"name": "CodigoCuenta2",
						"type": "varchar"
					},
					{
						"name": "NombreCuenta2",
						"type": "varchar"
					},
					{
						"name": "CodigoCuenta3",
						"type": "varchar"
					},
					{
						"name": "NombreCuenta3",
						"type": "varchar"
					},
					{
						"name": "CodigoCuenta4",
						"type": "varchar"
					},
					{
						"name": "NombreCuenta4",
						"type": "varchar"
					},
					{
						"name": "CodigoCuenta5",
						"type": "varchar"
					},
					{
						"name": "NombreCuenta5",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "dim",
					"table": "SapCuenta"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DWIM2')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DWThHitosBudget')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DWIM2",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DW2/MasterFecha"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "idFecha",
						"type": "int",
						"precision": 10
					},
					{
						"name": "idProyectoEtapa",
						"type": "int",
						"precision": 10
					},
					{
						"name": "idEscenario",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CodigoHito",
						"type": "varchar"
					},
					{
						"name": "OrdenHito",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Periodo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Proyecto",
						"type": "varchar"
					},
					{
						"name": "Etapa",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "th",
					"table": "HitosBudget"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DWIM2')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DWThHitosForecast')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DWIM2",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DW2/MasterFecha"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "idFecha",
						"type": "int",
						"precision": 10
					},
					{
						"name": "idProyectoEtapa",
						"type": "int",
						"precision": 10
					},
					{
						"name": "idEscenario",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CodigoHito",
						"type": "varchar"
					},
					{
						"name": "OrdenHito",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Periodo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Proyecto",
						"type": "varchar"
					},
					{
						"name": "Etapa",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "th",
					"table": "HitosForecast"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DWIM2')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/DWThHitosReal')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "DWIM2",
					"type": "LinkedServiceReference"
				},
				"folder": {
					"name": "DW2/MasterFecha"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "idFecha",
						"type": "int",
						"precision": 10
					},
					{
						"name": "idProyectoEtapa",
						"type": "int",
						"precision": 10
					},
					{
						"name": "idEscenario",
						"type": "int",
						"precision": 10
					},
					{
						"name": "CodigoHito",
						"type": "varchar"
					},
					{
						"name": "OrdenHito",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Proyecto",
						"type": "varchar"
					},
					{
						"name": "Etapa",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "th",
					"table": "HitosReal"
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/DWIM2')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/EscribirHES')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Publicar OC",
					"type": "LinkedServiceReference",
					"parameters": {
						"PayDays": "Value"
					}
				},
				"folder": {
					"name": "Otros"
				},
				"annotations": [],
				"type": "RestResource",
				"typeProperties": {},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/linkedServices/Publicar OC')]"
			]
		}
	]
}